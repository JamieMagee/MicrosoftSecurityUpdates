namespace JamieMagee.MicrosoftSecurityUpdates.Schema;

public sealed record VulnerabilityRemediation
{
    [JsonPropertyName("Description")]
    public VulnerabilityRemediationDescription? Description { get; init; }

    [JsonPropertyName("Entitlement")]
    public IEnumerable<VulnerabilityRemediationEntitlement>? Entitlement { get; init; }

    [JsonPropertyName("URL")]
    public string? Url { get; init; }

    [JsonPropertyName("Supercedence")]
    public string? Supercedence { get; init; }

    [JsonPropertyName("ProductId")]
    public IEnumerable<string>? ProductId { get; init; }

    [JsonPropertyName("GroupId")]
    public IEnumerable<string>? GroupId { get; init; }

    [JsonPropertyName("Type")]
    public VulnerabilityRemediationType Type { get; init; }

    [JsonPropertyName("Date")]
    public DateTimeOffset Date { get; init; }

    [JsonPropertyName("DateSpecified")]
    public bool DateSpecified { get; init; }

    [JsonPropertyName("AffectedFiles")]
    public required IEnumerable<AffectedFile> AffectedFiles { get; init; }

    [JsonPropertyName("RestartRequired")]
    public VulnerabilityRemediationRestartRequired? RestartRequired { get; init; }

    [JsonPropertyName("SubType")]
    public string? SubType { get; init; }

    [JsonPropertyName("FixedBuild")]
    public string? FixedBuild { get; init; }
}
