namespace JamieMagee.MicrosoftSecurityUpdates.Schema;

public sealed record Vulnerability
{
    [JsonPropertyName("Title")]
    public required VulnerabilityTitle Title { get; init; }

    [JsonPropertyName("ID")]
    public required VulnerabilityId Id { get; init; }

    [JsonPropertyName("Notes")]
    public required IEnumerable<VulnerabilityNote> Notes { get; init; }

    [JsonPropertyName("DiscoveryDate")]
    public DateTimeOffset DiscoveryDate { get; init; }

    [JsonPropertyName("DiscoveryDateSpecified")]
    public bool DiscoveryDateSpecified { get; init; }

    [JsonPropertyName("ReleaseDate")]
    public DateTimeOffset ReleaseDate { get; init; }

    [JsonPropertyName("ReleaseDateSpecified")]
    public bool ReleaseDateSpecified { get; init; }

    [JsonPropertyName("Involvements")]
    public required IEnumerable<VulnerabilityInvolvement> Involvements { get; init; }

    [JsonPropertyName("CVE")]
    public required string Cve { get; init; }

    [JsonPropertyName("CWE")]
    public required IEnumerable<VulnerabilityCwe> Cwe { get; init; }

    [JsonPropertyName("ProductStatuses")]
    public required IEnumerable<VulnerabilityStatus> ProductStatuses { get; init; }

    [JsonPropertyName("Threats")]
    public required IEnumerable<VulnerabilityThreat> Threats { get; init; }

    [JsonPropertyName("CVSSScoreSets")]
    public required IEnumerable<VulnerabilityScoreSet> CvssScoreSets { get; init; }

    [JsonPropertyName("Remediations")]
    public required IEnumerable<VulnerabilityRemediation> Remediations { get; init; }

    [JsonPropertyName("References")]
    public required IEnumerable<VulnerabilityReference> References { get; init; }

    [JsonPropertyName("Acknowledgments")]
    public required IEnumerable<VulnerabilityAcknowledgment> Acknowledgments { get; init; }

    [JsonPropertyName("Ordinal")]
    public required string Ordinal { get; init; }

    [JsonPropertyName("RevisionHistory")]
    public required IEnumerable<CvrfDocumentTrackingRevision> RevisionHistory { get; init; }
}
